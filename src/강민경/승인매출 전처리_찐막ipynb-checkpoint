{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "207e577b-ac35-471c-a6fe-222f239beb7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# 파일 경로 지정\n",
    "df = pd.read_csv (r'C:\\Users\\tsmce\\Desktop\\workspace\\final-project\\2018_승인매출정보_12월.csv',low_memory=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9fd7f553-69a2-4846-829e-889aaa49086e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경고 메시지 억제\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')   \n",
    "\n",
    "# 그래프 스타일 설정\n",
    "sns.set()                           # seaborn 기본 스타일 적용\n",
    "\n",
    "# matplotlib 그래프 기본 설정\n",
    "plt.rcParams['font.family'] = 'Malgun Gothic'  # 한글 폰트 설정\n",
    "# plt.rcParams['font.family'] = 'AppleGothic'  \n",
    "plt.rcParams['figure.figsize'] = (12, 6)       # 그림 크기 설정 (가로, 세로)\n",
    "plt.rcParams['font.size'] = 14                 # 폰트 크기 설정\n",
    "plt.rcParams['axes.unicode_minus'] = False     # 마이너스 기호 깨짐 방지\n",
    "\n",
    "# 결측치 시각화 라이브러리 임포트\n",
    "import missingno                          # 결측치 분포를 시각화하는 유틸리티\n",
    "\n",
    "# 범주형 변수 레이블 인코딩을 위한 도구 임포트\n",
    "from sklearn.preprocessing import LabelEncoder\n",
    "\n",
    "# 중복 조합 생성에 사용할 product 함수 임포트\n",
    "from itertools import product\n",
    "\n",
    "# 회귀 및 통계 분석을 위한 statsmodels 임포트\n",
    "import statsmodels.api as sm\n",
    "\n",
    "# 다중공선성 진단용 VIF 계산 함수 임포트\n",
    "from statsmodels.stats.outliers_influence import variance_inflation_factor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3b919d21-a021-499f-bf9d-62453f7c70a7",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['기준년월', 'ID', '최종이용일자_기본', '최종이용일자_신판', '최종이용일자_CA', '최종이용일자_카드론', '최종이용일자_체크', '최종이용일자_일시불', '최종이용일자_할부', '이용건수_신용_B0M', '이용건수_신판_B0M', '이용건수_일시불_B0M', '이용건수_할부_B0M', '이용건수_할부_유이자_B0M', '이용건수_할부_무이자_B0M', '이용건수_부분무이자_B0M', '이용건수_CA_B0M', '이용건수_체크_B0M', '이용건수_카드론_B0M', '이용금액_일시불_B0M', '이용금액_할부_B0M', '이용금액_할부_유이자_B0M', '이용금액_할부_무이자_B0M', '이용금액_부분무이자_B0M', '이용금액_CA_B0M', '이용금액_체크_B0M', '이용금액_카드론_B0M', '이용후경과월_신용', '이용후경과월_신판', '이용후경과월_일시불', '이용후경과월_할부', '이용후경과월_할부_유이자', '이용후경과월_할부_무이자', '이용후경과월_부분무이자', '이용후경과월_CA', '이용후경과월_체크', '이용후경과월_카드론', '이용건수_신용_R12M', '이용건수_신판_R12M', '이용건수_일시불_R12M', '이용건수_할부_R12M', '이용건수_할부_유이자_R12M', '이용건수_할부_무이자_R12M', '이용건수_부분무이자_R12M', '이용건수_CA_R12M', '이용건수_체크_R12M', '이용건수_카드론_R12M', '이용금액_일시불_R12M', '이용금액_할부_R12M', '이용금액_할부_유이자_R12M', '이용금액_할부_무이자_R12M', '이용금액_부분무이자_R12M', '이용금액_CA_R12M', '이용금액_체크_R12M', '이용금액_카드론_R12M', '최대이용금액_일시불_R12M', '최대이용금액_할부_R12M', '최대이용금액_할부_유이자_R12M', '최대이용금액_할부_무이자_R12M', '최대이용금액_부분무이자_R12M', '최대이용금액_CA_R12M', '최대이용금액_체크_R12M', '최대이용금액_카드론_R12M', '이용개월수_신용_R12M', '이용개월수_신판_R12M', '이용개월수_일시불_R12M', '이용개월수_할부_R12M', '이용개월수_할부_유이자_R12M', '이용개월수_할부_무이자_R12M', '이용개월수_부분무이자_R12M', '이용개월수_CA_R12M', '이용개월수_체크_R12M', '이용개월수_카드론_R12M', '이용건수_신용_R6M', '이용건수_신판_R6M', '이용건수_일시불_R6M', '이용건수_할부_R6M', '이용건수_할부_유이자_R6M', '이용건수_할부_무이자_R6M', '이용건수_부분무이자_R6M', '이용건수_CA_R6M', '이용건수_체크_R6M', '이용건수_카드론_R6M', '이용금액_일시불_R6M', '이용금액_할부_R6M', '이용금액_할부_유이자_R6M', '이용금액_할부_무이자_R6M', '이용금액_부분무이자_R6M', '이용금액_CA_R6M', '이용금액_체크_R6M', '이용금액_카드론_R6M', '이용개월수_신용_R6M', '이용개월수_신판_R6M', '이용개월수_일시불_R6M', '이용개월수_할부_R6M', '이용개월수_할부_유이자_R6M', '이용개월수_할부_무이자_R6M', '이용개월수_부분무이자_R6M', '이용개월수_CA_R6M', '이용개월수_체크_R6M', '이용개월수_카드론_R6M', '이용건수_신용_R3M', '이용건수_신판_R3M', '이용건수_일시불_R3M', '이용건수_할부_R3M', '이용건수_할부_유이자_R3M', '이용건수_할부_무이자_R3M', '이용건수_부분무이자_R3M', '이용건수_CA_R3M', '이용건수_체크_R3M', '이용건수_카드론_R3M', '이용금액_일시불_R3M', '이용금액_할부_R3M', '이용금액_할부_유이자_R3M', '이용금액_할부_무이자_R3M', '이용금액_부분무이자_R3M', '이용금액_CA_R3M', '이용금액_체크_R3M', '이용금액_카드론_R3M', '이용개월수_신용_R3M', '이용개월수_신판_R3M', '이용개월수_일시불_R3M', '이용개월수_할부_R3M', '이용개월수_할부_유이자_R3M', '이용개월수_할부_무이자_R3M', '이용개월수_부분무이자_R3M', '이용개월수_CA_R3M', '이용개월수_체크_R3M', '이용개월수_카드론_R3M', '이용가맹점수', '이용금액_해외', '쇼핑_도소매_이용금액', '쇼핑_백화점_이용금액', '쇼핑_마트_이용금액', '쇼핑_슈퍼마켓_이용금액', '쇼핑_편의점_이용금액', '쇼핑_아울렛_이용금액', '쇼핑_온라인_이용금액', '쇼핑_기타_이용금액', '교통_주유이용금액', '교통_정비이용금액', '교통_통행료이용금액', '교통_버스지하철이용금액', '교통_택시이용금액', '교통_철도버스이용금액', '여유_운동이용금액', '여유_Pet이용금액', '여유_공연이용금액', '여유_공원이용금액', '여유_숙박이용금액', '여유_여행이용금액', '여유_항공이용금액', '여유_기타이용금액', '납부_통신비이용금액', '납부_관리비이용금액', '납부_렌탈료이용금액', '납부_가스전기료이용금액', '납부_보험료이용금액', '납부_유선방송이용금액', '납부_건강연금이용금액', '납부_기타이용금액', '_1순위업종', '_1순위업종_이용금액', '_2순위업종', '_2순위업종_이용금액', '_3순위업종', '_3순위업종_이용금액', '_1순위쇼핑업종', '_1순위쇼핑업종_이용금액', '_2순위쇼핑업종', '_2순위쇼핑업종_이용금액', '_3순위쇼핑업종', '_3순위쇼핑업종_이용금액', '_1순위교통업종', '_1순위교통업종_이용금액', '_2순위교통업종', '_2순위교통업종_이용금액', '_3순위교통업종', '_3순위교통업종_이용금액', '_1순위여유업종', '_1순위여유업종_이용금액', '_2순위여유업종', '_2순위여유업종_이용금액', '_3순위여유업종', '_3순위여유업종_이용금액', '_1순위납부업종', '_1순위납부업종_이용금액', '_2순위납부업종', '_2순위납부업종_이용금액', '_3순위납부업종', '_3순위납부업종_이용금액', '할부건수_3M_R12M', '할부건수_6M_R12M', '할부건수_12M_R12M', '할부건수_14M_R12M', '할부금액_3M_R12M', '할부금액_6M_R12M', '할부금액_12M_R12M', '할부금액_14M_R12M', '할부건수_유이자_3M_R12M', '할부건수_유이자_6M_R12M', '할부건수_유이자_12M_R12M', '할부건수_유이자_14M_R12M', '할부금액_유이자_3M_R12M', '할부금액_유이자_6M_R12M', '할부금액_유이자_12M_R12M', '할부금액_유이자_14M_R12M', '할부건수_무이자_3M_R12M', '할부건수_무이자_6M_R12M', '할부건수_무이자_12M_R12M', '할부건수_무이자_14M_R12M', '할부금액_무이자_3M_R12M', '할부금액_무이자_6M_R12M', '할부금액_무이자_12M_R12M', '할부금액_무이자_14M_R12M', '할부건수_부분_3M_R12M', '할부건수_부분_6M_R12M', '할부건수_부분_12M_R12M', '할부건수_부분_14M_R12M', '할부금액_부분_3M_R12M', '할부금액_부분_6M_R12M', '할부금액_부분_12M_R12M', '할부금액_부분_14M_R12M', 'RP건수_B0M', 'RP금액_B0M', 'RP유형건수_B0M', 'RP건수_통신_B0M', 'RP건수_아파트_B0M', 'RP건수_제휴사서비스직접판매_B0M', 'RP건수_렌탈_B0M', 'RP건수_가스_B0M', 'RP건수_전기_B0M', 'RP건수_보험_B0M', 'RP건수_학습비_B0M', 'RP건수_유선방송_B0M', 'RP건수_건강_B0M', 'RP건수_교통_B0M', 'RP후경과월', 'RP후경과월_통신', 'RP후경과월_아파트', 'RP후경과월_제휴사서비스직접판매', 'RP후경과월_렌탈', 'RP후경과월_가스', 'RP후경과월_전기', 'RP후경과월_보험', 'RP후경과월_학습비', 'RP후경과월_유선방송', 'RP후경과월_건강', 'RP후경과월_교통', '증감_RP건수_전월', '증감_RP유형건수_전월', '증감_RP건수_통신_전월', '증감_RP건수_아파트_전월', '증감_RP건수_제휴사서비스직접판매_전월', '증감_RP건수_렌탈_전월', '증감_RP건수_가스_전월', '증감_RP건수_전기_전월', '증감_RP건수_보험_전월', '증감_RP건수_학습비_전월', '증감_RP건수_유선방송_전월', '증감_RP건수_건강_전월', '증감_RP건수_교통_전월', '최초카드론이용경과월', '최종카드론이용경과월', '카드론이용건수_누적', '카드론이용월수_누적', '카드론이용금액_누적', '최종카드론_금융상환방식코드', '최종카드론_신청경로코드', '최종카드론_대출이율', '최종카드론_대출일자', '최종카드론_대출월수', '최종카드론_거치개월수', '최종카드론_대출금액', '이용개월수_온라인_R6M', '이용개월수_오프라인_R6M', '이용금액_온라인_R6M', '이용금액_오프라인_R6M', '이용건수_온라인_R6M', '이용건수_오프라인_R6M', '이용금액_온라인_R3M', '이용금액_오프라인_R3M', '이용건수_온라인_R3M', '이용건수_오프라인_R3M', '이용금액_온라인_B0M', '이용금액_오프라인_B0M', '이용건수_온라인_B0M', '이용건수_오프라인_B0M', '이용개월수_페이_온라인_R6M', '이용개월수_페이_오프라인_R6M', '이용금액_페이_온라인_R6M', '이용금액_페이_오프라인_R6M', '이용건수_페이_온라인_R6M', '이용건수_페이_오프라인_R6M', '이용금액_페이_온라인_R3M', '이용금액_페이_오프라인_R3M', '이용건수_페이_온라인_R3M', '이용건수_페이_오프라인_R3M', '이용금액_페이_온라인_B0M', '이용금액_페이_오프라인_B0M', '이용건수_페이_온라인_B0M', '이용건수_페이_오프라인_B0M', '이용개월수_간편결제_R6M', '이용개월수_당사페이_R6M', '이용개월수_당사기타_R6M', '이용개월수_A페이_R6M', '이용개월수_B페이_R6M', '이용개월수_C페이_R6M', '이용개월수_D페이_R6M', '이용금액_간편결제_R6M', '이용금액_당사페이_R6M', '이용금액_당사기타_R6M', '이용금액_A페이_R6M', '이용금액_B페이_R6M', '이용금액_C페이_R6M', '이용금액_D페이_R6M', '이용건수_간편결제_R6M', '이용건수_당사페이_R6M', '이용건수_당사기타_R6M', '이용건수_A페이_R6M', '이용건수_B페이_R6M', '이용건수_C페이_R6M', '이용건수_D페이_R6M', '이용금액_간편결제_R3M', '이용금액_당사페이_R3M', '이용금액_당사기타_R3M', '이용금액_A페이_R3M', '이용금액_B페이_R3M', '이용금액_C페이_R3M', '이용금액_D페이_R3M', '이용건수_간편결제_R3M', '이용건수_당사페이_R3M', '이용건수_당사기타_R3M', '이용건수_A페이_R3M', '이용건수_B페이_R3M', '이용건수_C페이_R3M', '이용건수_D페이_R3M', '이용금액_간편결제_B0M', '이용금액_당사페이_B0M', '이용금액_당사기타_B0M', '이용금액_A페이_B0M', '이용금액_B페이_B0M', '이용금액_C페이_B0M', '이용금액_D페이_B0M', '이용건수_간편결제_B0M', '이용건수_당사페이_B0M', '이용건수_당사기타_B0M', '이용건수_A페이_B0M', '이용건수_B페이_B0M', '이용건수_C페이_B0M', '이용건수_D페이_B0M', '이용개월수_선결제_R6M', '이용횟수_선결제_R6M', '이용금액_선결제_R6M', '이용건수_선결제_R6M', '이용횟수_선결제_R3M', '이용금액_선결제_R3M', '이용건수_선결제_R3M', '이용횟수_선결제_B0M', '이용금액_선결제_B0M', '이용건수_선결제_B0M', '이용횟수_연체_R6M', '이용금액_연체_R6M', '이용횟수_연체_R3M', '이용금액_연체_R3M', '이용횟수_연체_B0M', '이용금액_연체_B0M', '이용개월수_전체_R6M', '이용개월수_전체_R3M', '이용개월수_결제일_R6M', '이용개월수_결제일_R3M', '가맹점매출금액_B1M', '가맹점매출금액_B2M', '정상청구원금_B0M', '선입금원금_B0M', '정상입금원금_B0M', '연체입금원금_B0M', '정상청구원금_B2M', '선입금원금_B2M', '정상입금원금_B2M', '연체입금원금_B2M', '정상청구원금_B5M', '선입금원금_B5M', '정상입금원금_B5M', '연체입금원금_B5M', '건수_할부전환_R6M', '건수_할부전환_R3M', '금액_할부전환_R6M', '금액_할부전환_R3M', '연속무실적개월수_기본_24M_카드', '연속유실적개월수_기본_24M_카드', '신청건수_ATM_CA_B0', '신청건수_ATM_CL_B0', '신청건수_ATM_CA_R6M', '신청건수_ATM_CL_R6M', '승인거절건수_B0M', '승인거절건수_한도초과_B0M', '승인거절건수_BL_B0M', '승인거절건수_입력오류_B0M', '승인거절건수_기타_B0M', '승인거절건수_R3M', '승인거절건수_한도초과_R3M', '승인거절건수_BL_R3M', '승인거절건수_입력오류_R3M', '승인거절건수_기타_R3M', '이용금액대']\n"
     ]
    }
   ],
   "source": [
    "print(df.columns.tolist())  # 모든 컬럼명 리스트 출력"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "cdc2a150-537d-4dcd-ac69-dbc25f73c5db",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             ID  최종이용일자_기본  최종이용일자_신판  최종이용일자_CA  최종이용일자_카드론  최종이용일자_체크  \\\n",
      "0  TRAIN_000000   20181224   20181224   20181221       10101   20180203   \n",
      "1  TRAIN_000001   20181214   20181214   20170728    20170327      10101   \n",
      "2  TRAIN_000002   20181228   20181228   20181216    20151119   20141230   \n",
      "3  TRAIN_000003   20181221   20181212   20181221       10101   20141111   \n",
      "4  TRAIN_000004   20180905   20180905      10101       10101   20181210   \n",
      "\n",
      "   최종이용일자_일시불  최종이용일자_할부  이용건수_신용_B0M  이용건수_신판_B0M  ...  승인거절건수_한도초과_B0M  \\\n",
      "0    20181224   20180713            7            5  ...                0   \n",
      "1    20181214   20171231            9            9  ...                0   \n",
      "2    20181228   20181115           20           18  ...                0   \n",
      "3    20181203   20181212           12           10  ...                0   \n",
      "4    20180905      10101            0            0  ...                0   \n",
      "\n",
      "   승인거절건수_BL_B0M  승인거절건수_입력오류_B0M  승인거절건수_기타_B0M  승인거절건수_R3M  승인거절건수_한도초과_R3M  \\\n",
      "0              0                0              0           0                0   \n",
      "1              0                0              0           0                0   \n",
      "2              0                0              0           0                0   \n",
      "3              0                0              0           0                0   \n",
      "4              0                0              0           0                0   \n",
      "\n",
      "   승인거절건수_BL_R3M  승인거절건수_입력오류_R3M  승인거절건수_기타_R3M      이용금액대  \n",
      "0              0                0              0  01.100만원+  \n",
      "1              0                0              0   03.30만원+  \n",
      "2              0                0              0  01.100만원+  \n",
      "3              0                0              0  01.100만원+  \n",
      "4              0                0              0   05.10만원-  \n",
      "\n",
      "[5 rows x 405 columns]\n"
     ]
    }
   ],
   "source": [
    "# 기준년월 컬럼 제거\n",
    "df = df.drop(columns=['기준년월'])\n",
    "\n",
    "# 잘 적용됐는지 확인\n",
    "print(df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e226249c-7f50-4d0c-b43f-d93e61ba72a7",
   "metadata": {},
   "outputs": [],
   "source": [
    "column_categories = {\n",
    "    '기본정보': [\n",
    "        'ID', '이용가맹점수', '이용금액대'\n",
    "    ],\n",
    "    '이용일자정보': [col for col in df.columns if '이용일자' in col or '대출일자' in col],\n",
    "    '이용건수정보': [col for col in df.columns if '이용건수_' in col or '건수_' in col],\n",
    "    '이용금액정보': [col for col in df.columns if '이용금액_' in col or '금액_' in col],\n",
    "    '이용개월수정보': [col for col in df.columns if '이용개월수_' in col],\n",
    "    '이용후경과월정보': [col for col in df.columns if '이용후경과월' in col],\n",
    "    'RP정보': [col for col in df.columns if col.startswith('RP') or '증감_RP' in col],\n",
    "    '쇼핑교통여유납부정보': [col for col in df.columns if any(x in col for x in ['쇼핑_', '교통_', '여유_', '납부_'])],\n",
    "    '업종순위정보': [col for col in df.columns if '순위업종' in col],\n",
    "    '할부상세정보': [col for col in df.columns if col.startswith('할부') or '부분' in col],\n",
    "    '카드론정보': [col for col in df.columns if '카드론' in col],\n",
    "    '간편결제정보': [col for col in df.columns if any(x in col for x in ['페이', '간편결제', '당사페이', 'A페이', 'B페이', 'C페이', 'D페이'])],\n",
    "    '선결제정보': [col for col in df.columns if '선결제' in col],\n",
    "    '연체정보': [col for col in df.columns if '연체' in col],\n",
    "    '청구입금정보': [col for col in df.columns if any(x in col for x in ['청구원금', '입금원금'])],\n",
    "    '할부전환정보': [col for col in df.columns if '할부전환' in col],\n",
    "    '승인거절정보': [col for col in df.columns if '승인거절건수' in col],\n",
    "    '결제일정보': [col for col in df.columns if '결제일' in col]\n",
    "}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "910e8cd2-2a31-42bc-bc8c-0ff53a843f32",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "📂 기본정보:\n",
      "        mean  min    max\n",
      "이용가맹점수  19.0  0.0  106.0\n",
      "\n",
      "📂 이용일자정보:\n",
      "                  mean         min         max\n",
      "최종이용일자_기본   19408790.6     10101.0  20181231.0\n",
      "최종이용일자_신판   19402976.6     10101.0  20181231.0\n",
      "최종이용일자_CA    6434422.4     10101.0  20181231.0\n",
      "최종이용일자_카드론   3463684.6     10101.0  20181215.0\n",
      "최종이용일자_체크    7427225.9     10101.0  20181231.0\n",
      "최종이용일자_일시불  19369333.9     10101.0  20181231.0\n",
      "최종이용일자_할부   14580202.1     10101.0  20181231.0\n",
      "최종카드론_대출일자  20161950.4  20130628.0  20181215.0\n",
      "\n",
      "📂 이용건수정보:\n",
      "                 mean  min   max\n",
      "이용건수_신용_B0M      13.8 -3.0  89.0\n",
      "이용건수_신판_B0M      13.7 -3.0  88.0\n",
      "이용건수_일시불_B0M     13.6 -3.0  87.0\n",
      "이용건수_할부_B0M       0.1  0.0   3.0\n",
      "이용건수_할부_유이자_B0M   0.0  0.0   1.0\n",
      "...               ...  ...   ...\n",
      "승인거절건수_R3M        0.0  0.0   6.0\n",
      "승인거절건수_한도초과_R3M   0.0  0.0   6.0\n",
      "승인거절건수_BL_R3M     0.0  0.0   3.0\n",
      "승인거절건수_입력오류_R3M   0.0  0.0   0.0\n",
      "승인거절건수_기타_R3M     0.0  0.0   0.0\n",
      "\n",
      "[135 rows x 3 columns]\n",
      "\n",
      "📂 이용금액정보:\n",
      "                   mean     min      max\n",
      "이용금액_일시불_B0M     3437.5 -2754.0  30072.0\n",
      "이용금액_할부_B0M       414.2     0.0  13023.0\n",
      "이용금액_할부_유이자_B0M   119.3     0.0   7315.0\n",
      "이용금액_할부_무이자_B0M   294.9     0.0   8715.0\n",
      "이용금액_부분무이자_B0M      0.0     0.0      0.0\n",
      "...                 ...     ...      ...\n",
      "이용금액_연체_B0M        44.2     0.0   4690.0\n",
      "가맹점매출금액_B1M       348.2     0.0  11878.0\n",
      "가맹점매출금액_B2M       351.2     0.0  12485.0\n",
      "금액_할부전환_R6M       125.4     0.0  15542.0\n",
      "금액_할부전환_R3M        68.2     0.0   8747.0\n",
      "\n",
      "[102 rows x 3 columns]\n",
      "\n",
      "📂 이용개월수정보:\n",
      "                   mean  min   max\n",
      "이용개월수_신용_R12M       8.9  0.0  12.0\n",
      "이용개월수_신판_R12M       8.8  0.0  12.0\n",
      "이용개월수_일시불_R12M      8.7  0.0  12.0\n",
      "이용개월수_할부_R12M       1.9  0.0  11.0\n",
      "이용개월수_할부_유이자_R12M   0.5  0.0   5.0\n",
      "이용개월수_할부_무이자_R12M   1.5  0.0   9.0\n",
      "이용개월수_부분무이자_R12M    0.0  0.0   1.0\n",
      "이용개월수_CA_R12M       0.6  0.0  12.0\n",
      "이용개월수_체크_R12M       1.6  0.0  12.0\n",
      "이용개월수_카드론_R12M      0.0  0.0   2.0\n",
      "이용개월수_신용_R6M        4.6  0.0   6.0\n",
      "이용개월수_신판_R6M        4.6  0.0   6.0\n",
      "이용개월수_일시불_R6M       4.6  0.0   6.0\n",
      "이용개월수_할부_R6M        0.7  0.0   6.0\n",
      "이용개월수_할부_유이자_R6M    0.2  0.0   6.0\n",
      "이용개월수_할부_무이자_R6M    0.5  0.0   6.0\n",
      "이용개월수_부분무이자_R6M     0.0  0.0   1.0\n",
      "이용개월수_CA_R6M        0.3  0.0   6.0\n",
      "이용개월수_체크_R6M        0.8  0.0   6.0\n",
      "이용개월수_카드론_R6M       0.0  0.0   2.0\n",
      "이용개월수_신용_R3M        2.3  0.0   3.0\n",
      "이용개월수_신판_R3M        2.3  0.0   3.0\n",
      "이용개월수_일시불_R3M       2.3  0.0   3.0\n",
      "이용개월수_할부_R3M        0.4  0.0   3.0\n",
      "이용개월수_할부_유이자_R3M    0.1  0.0   3.0\n",
      "이용개월수_할부_무이자_R3M    0.3  0.0   3.0\n",
      "이용개월수_부분무이자_R3M     0.0  0.0   0.0\n",
      "이용개월수_CA_R3M        0.1  0.0   3.0\n",
      "이용개월수_체크_R3M        0.4  0.0   3.0\n",
      "이용개월수_카드론_R3M       0.0  0.0   1.0\n",
      "이용개월수_온라인_R6M       1.2  0.0   6.0\n",
      "이용개월수_오프라인_R6M      4.2  0.0   6.0\n",
      "이용개월수_페이_온라인_R6M    1.3  0.0   6.0\n",
      "이용개월수_페이_오프라인_R6M   0.4  0.0   6.0\n",
      "이용개월수_간편결제_R6M      1.5  0.0   6.0\n",
      "이용개월수_당사페이_R6M      0.0  0.0   0.0\n",
      "이용개월수_당사기타_R6M      0.0  0.0   0.0\n",
      "이용개월수_A페이_R6M       0.4  0.0   6.0\n",
      "이용개월수_B페이_R6M       0.1  0.0   6.0\n",
      "이용개월수_C페이_R6M       0.1  0.0   6.0\n",
      "이용개월수_D페이_R6M       0.0  0.0   6.0\n",
      "이용개월수_선결제_R6M       0.1  0.0   6.0\n",
      "이용개월수_전체_R6M        4.5  0.0   6.0\n",
      "이용개월수_전체_R3M        2.2  0.0   3.0\n",
      "이용개월수_결제일_R6M       4.2  0.0   6.0\n",
      "이용개월수_결제일_R3M       2.1  0.0   3.0\n",
      "\n",
      "📂 이용후경과월정보:\n",
      "               mean  min   max\n",
      "이용후경과월_신용       2.8  0.0  12.0\n",
      "이용후경과월_신판       2.9  0.0  12.0\n",
      "이용후경과월_일시불      1.8  0.0  12.0\n",
      "이용후경과월_할부       8.4  0.0  12.0\n",
      "이용후경과월_할부_유이자  10.3  0.0  12.0\n",
      "이용후경과월_할부_무이자   8.7  0.0  12.0\n",
      "이용후경과월_부분무이자   11.9  0.0  12.0\n",
      "이용후경과월_CA      11.2  0.0  12.0\n",
      "이용후경과월_체크      10.2  0.0  12.0\n",
      "이용후경과월_카드론     11.8  0.0  12.0\n",
      "\n",
      "📂 RP정보:\n",
      "                        mean  min      max\n",
      "RP건수_B0M                 0.8  0.0      8.0\n",
      "RP금액_B0M               328.7  0.0  23768.0\n",
      "RP유형건수_B0M               0.6  0.0      4.0\n",
      "RP건수_통신_B0M              0.3  0.0      2.0\n",
      "RP건수_아파트_B0M             0.0  0.0      1.0\n",
      "RP건수_제휴사서비스직접판매_B0M      0.1  0.0      1.0\n",
      "RP건수_렌탈_B0M              0.0  0.0      2.0\n",
      "RP건수_가스_B0M              0.0  0.0      1.0\n",
      "RP건수_전기_B0M              0.0  0.0      1.0\n",
      "RP건수_보험_B0M              0.0  0.0      1.0\n",
      "RP건수_학습비_B0M             0.0  0.0      3.0\n",
      "RP건수_유선방송_B0M            0.0  0.0      0.0\n",
      "RP건수_건강_B0M              0.0  0.0      0.0\n",
      "RP건수_교통_B0M              0.3  0.0      3.0\n",
      "RP후경과월                   3.1  0.0      6.0\n",
      "RP후경과월_통신                4.4  0.0      6.0\n",
      "RP후경과월_아파트               5.8  0.0      6.0\n",
      "RP후경과월_제휴사서비스직접판매        5.4  0.0      6.0\n",
      "RP후경과월_렌탈                6.0  0.0      6.0\n",
      "RP후경과월_가스                5.9  0.0      6.0\n",
      "RP후경과월_전기                6.0  0.0      6.0\n",
      "RP후경과월_보험                5.9  0.0      6.0\n",
      "RP후경과월_학습비               6.0  0.0      6.0\n",
      "RP후경과월_유선방송              6.0  6.0      6.0\n",
      "RP후경과월_건강                6.0  6.0      6.0\n",
      "RP후경과월_교통                4.7  0.0      6.0\n",
      "증감_RP건수_전월               0.0 -4.0      3.0\n",
      "증감_RP유형건수_전월             0.0 -1.0      1.0\n",
      "증감_RP건수_통신_전월            0.0 -2.0      2.0\n",
      "증감_RP건수_아파트_전월          -0.0 -1.0      1.0\n",
      "증감_RP건수_제휴사서비스직접판매_전월    0.0 -1.0      1.0\n",
      "증감_RP건수_렌탈_전월            0.0 -1.0      2.0\n",
      "증감_RP건수_가스_전월           -0.0 -1.0      1.0\n",
      "증감_RP건수_전기_전월            0.0 -1.0      1.0\n",
      "증감_RP건수_보험_전월            0.0 -1.0      1.0\n",
      "증감_RP건수_학습비_전월           0.0 -3.0      3.0\n",
      "증감_RP건수_유선방송_전월          0.0  0.0      0.0\n",
      "증감_RP건수_건강_전월            0.0  0.0      0.0\n",
      "증감_RP건수_교통_전월           -0.0 -2.0      1.0\n",
      "\n",
      "📂 쇼핑교통여유납부정보:\n",
      "                 mean  min       max\n",
      "쇼핑_도소매_이용금액     495.1  0.0   10901.0\n",
      "쇼핑_백화점_이용금액     107.6  0.0    2242.0\n",
      "쇼핑_마트_이용금액      348.9  0.0    6393.0\n",
      "쇼핑_슈퍼마켓_이용금액    335.7  0.0    6984.0\n",
      "쇼핑_편의점_이용금액     165.1  0.0    7831.0\n",
      "쇼핑_아울렛_이용금액      30.1  0.0    1199.0\n",
      "쇼핑_온라인_이용금액    1789.9  0.0  136075.0\n",
      "쇼핑_기타_이용금액       83.0  0.0    1076.0\n",
      "교통_주유이용금액       628.4  0.0   14490.0\n",
      "교통_정비이용금액        94.5  0.0    1707.0\n",
      "교통_통행료이용금액        0.0  0.0     367.0\n",
      "교통_버스지하철이용금액    158.8  0.0    2136.0\n",
      "교통_택시이용금액        54.4  0.0     972.0\n",
      "교통_철도버스이용금액      26.4  0.0    1025.0\n",
      "여유_운동이용금액        70.4  0.0    3507.0\n",
      "여유_Pet이용금액        1.6  0.0     942.0\n",
      "여유_공연이용금액         6.0  0.0     322.0\n",
      "여유_공원이용금액         0.2  0.0     358.0\n",
      "여유_숙박이용금액         3.5  0.0    1135.0\n",
      "여유_여행이용금액         0.0  0.0       0.0\n",
      "여유_항공이용금액         2.5  0.0    4759.0\n",
      "여유_기타이용금액         2.4  0.0     385.0\n",
      "납부_통신비이용금액      582.7  0.0    9273.0\n",
      "납부_관리비이용금액      145.9  0.0    5512.0\n",
      "납부_렌탈료이용금액        0.0  0.0       0.0\n",
      "납부_가스전기료이용금액     13.0  0.0     984.0\n",
      "납부_보험료이용금액      218.6  0.0    4551.0\n",
      "납부_유선방송이용금액       0.0  0.0       0.0\n",
      "납부_건강연금이용금액       0.0  0.0       0.0\n",
      "납부_기타이용금액        29.3  0.0    1425.0\n",
      "RP건수_교통_B0M       0.3  0.0       3.0\n",
      "증감_RP건수_교통_전월    -0.0 -2.0       1.0\n",
      "\n",
      "📂 업종순위정보:\n",
      "               mean  min       max\n",
      "_1순위업종_이용금액  5214.8  0.0  190187.0\n",
      "_2순위업종_이용금액  1845.1  0.0   37142.0\n",
      "_3순위업종_이용금액  1060.5  0.0   22186.0\n",
      "\n",
      "📂 할부상세정보:\n",
      "                     mean  min       max\n",
      "이용건수_부분무이자_B0M        0.0  0.0       0.0\n",
      "이용금액_부분무이자_B0M        0.0  0.0       0.0\n",
      "이용후경과월_부분무이자         11.9  0.0      12.0\n",
      "이용건수_부분무이자_R12M       0.0  0.0       3.0\n",
      "이용금액_부분무이자_R12M     165.0  0.0   19075.0\n",
      "최대이용금액_부분무이자_R12M   160.8  0.0   10860.0\n",
      "이용개월수_부분무이자_R12M      0.0  0.0       1.0\n",
      "이용건수_부분무이자_R6M        0.0  0.0       0.0\n",
      "이용금액_부분무이자_R6M        0.0  0.0       0.0\n",
      "이용개월수_부분무이자_R6M       0.0  0.0       1.0\n",
      "이용건수_부분무이자_R3M        0.0  0.0       0.0\n",
      "이용금액_부분무이자_R3M        0.0  0.0       0.0\n",
      "이용개월수_부분무이자_R3M       0.0  0.0       0.0\n",
      "할부건수_3M_R12M          2.2  0.0      54.0\n",
      "할부건수_6M_R12M          0.8  0.0      20.0\n",
      "할부건수_12M_R12M         0.0  0.0       8.0\n",
      "할부건수_14M_R12M         0.0  0.0       4.0\n",
      "할부금액_3M_R12M       4129.4  0.0  240337.0\n",
      "할부금액_6M_R12M       2186.0  0.0   60076.0\n",
      "할부금액_12M_R12M       496.4  0.0   25633.0\n",
      "할부금액_14M_R12M        93.0  0.0   31813.0\n",
      "할부건수_유이자_3M_R12M      0.5  0.0      18.0\n",
      "할부건수_유이자_6M_R12M      0.1  0.0       6.0\n",
      "할부건수_유이자_12M_R12M     0.0  0.0       5.0\n",
      "할부건수_유이자_14M_R12M     0.0  0.0       4.0\n",
      "할부금액_유이자_3M_R12M   1301.7  0.0   27753.0\n",
      "할부금액_유이자_6M_R12M    498.8  0.0   15456.0\n",
      "할부금액_유이자_12M_R12M   200.5  0.0   19099.0\n",
      "할부금액_유이자_14M_R12M    88.2  0.0    6127.0\n",
      "할부건수_무이자_3M_R12M      1.7  0.0      48.0\n",
      "할부건수_무이자_6M_R12M      0.7  0.0      16.0\n",
      "할부건수_무이자_12M_R12M     0.0  0.0       4.0\n",
      "할부건수_무이자_14M_R12M     0.0  0.0       0.0\n",
      "할부금액_무이자_3M_R12M   2827.6  0.0  240337.0\n",
      "할부금액_무이자_6M_R12M   1687.2  0.0   58755.0\n",
      "할부금액_무이자_12M_R12M   131.1  0.0    6183.0\n",
      "할부금액_무이자_14M_R12M     4.7  0.0   31813.0\n",
      "할부건수_부분_3M_R12M       0.0  0.0       0.0\n",
      "할부건수_부분_6M_R12M       0.0  0.0       0.0\n",
      "할부건수_부분_12M_R12M      0.0  0.0       3.0\n",
      "할부건수_부분_14M_R12M      0.0  0.0       0.0\n",
      "할부금액_부분_3M_R12M       0.0  0.0       0.0\n",
      "할부금액_부분_6M_R12M       0.0  0.0       0.0\n",
      "할부금액_부분_12M_R12M    164.9  0.0   11055.0\n",
      "할부금액_부분_14M_R12M      0.1  0.0   10469.0\n",
      "\n",
      "📂 카드론정보:\n",
      "                       mean         min         max\n",
      "최종이용일자_카드론        3463684.6     10101.0  20181215.0\n",
      "이용건수_카드론_B0M            0.0         0.0         1.0\n",
      "이용금액_카드론_B0M            0.3         0.0     74425.0\n",
      "이용후경과월_카드론             11.8         0.0        12.0\n",
      "이용건수_카드론_R12M           0.1         0.0         3.0\n",
      "이용금액_카드론_R12M        3099.5         0.0    300279.0\n",
      "최대이용금액_카드론_R12M      2889.5         0.0    196903.0\n",
      "이용개월수_카드론_R12M          0.0         0.0         2.0\n",
      "이용건수_카드론_R6M            0.0         0.0         1.0\n",
      "이용금액_카드론_R6M           17.7         0.0     74425.0\n",
      "이용개월수_카드론_R6M           0.0         0.0         2.0\n",
      "이용건수_카드론_R3M            0.0         0.0         1.0\n",
      "이용금액_카드론_R3M            0.4         0.0     74425.0\n",
      "이용개월수_카드론_R3M           0.0         0.0         1.0\n",
      "최초카드론이용경과월            825.1         4.0       999.0\n",
      "최종카드론이용경과월            832.6         0.0       999.0\n",
      "카드론이용건수_누적              0.7         0.0        17.0\n",
      "카드론이용월수_누적              0.6         0.0        14.0\n",
      "카드론이용금액_누적          25572.8         0.0   1903389.0\n",
      "최종카드론_금융상환방식코드          2.8         2.0         5.0\n",
      "최종카드론_대출이율              2.8         0.0        20.4\n",
      "최종카드론_대출일자       20161950.4  20130628.0  20181215.0\n",
      "최종카드론_대출월수              4.0         0.0        36.0\n",
      "최종카드론_거치개월수             0.2         0.0         6.0\n",
      "최종카드론_대출금액          10171.7         0.0    177487.0\n",
      "\n",
      "📂 간편결제정보:\n",
      "                     mean  min       max\n",
      "이용개월수_페이_온라인_R6M      1.3  0.0       6.0\n",
      "이용개월수_페이_오프라인_R6M     0.4  0.0       6.0\n",
      "이용금액_페이_온라인_R6M    2360.8  0.0   73940.0\n",
      "이용금액_페이_오프라인_R6M    530.6  0.0   24466.0\n",
      "이용건수_페이_온라인_R6M       1.6  0.0      19.0\n",
      "이용건수_페이_오프라인_R6M      0.4  0.0       6.0\n",
      "이용금액_페이_온라인_R3M    1215.0  0.0   41847.0\n",
      "이용금액_페이_오프라인_R3M    269.6  0.0   13698.0\n",
      "이용건수_페이_온라인_R3M       0.9  0.0      10.0\n",
      "이용건수_페이_오프라인_R3M      0.2  0.0       3.0\n",
      "이용금액_페이_온라인_B0M     419.5  0.0   16047.0\n",
      "이용금액_페이_오프라인_B0M     90.7  0.0    4967.0\n",
      "이용건수_페이_온라인_B0M       0.3  0.0       3.0\n",
      "이용건수_페이_오프라인_B0M      0.1  0.0       1.0\n",
      "이용개월수_간편결제_R6M        1.5  0.0       6.0\n",
      "이용개월수_당사페이_R6M        0.0  0.0       0.0\n",
      "이용개월수_A페이_R6M         0.4  0.0       6.0\n",
      "이용개월수_B페이_R6M         0.1  0.0       6.0\n",
      "이용개월수_C페이_R6M         0.1  0.0       6.0\n",
      "이용개월수_D페이_R6M         0.0  0.0       6.0\n",
      "이용금액_간편결제_R6M      3193.4  0.0  153280.0\n",
      "이용금액_당사페이_R6M         0.0  0.0       0.0\n",
      "이용금액_A페이_R6M        673.9  0.0   31535.0\n",
      "이용금액_B페이_R6M         54.6  0.0    4543.0\n",
      "이용금액_C페이_R6M         48.2  0.0    3935.0\n",
      "이용금액_D페이_R6M          5.7  0.0    1967.0\n",
      "이용건수_간편결제_R6M         3.3  0.0      30.0\n",
      "이용건수_당사페이_R6M         0.0  0.0       0.0\n",
      "이용건수_A페이_R6M          0.4  0.0       6.0\n",
      "이용건수_B페이_R6M          0.1  0.0       6.0\n",
      "이용건수_C페이_R6M          0.1  0.0       6.0\n",
      "이용건수_D페이_R6M          0.0  0.0       6.0\n",
      "이용금액_간편결제_R3M      1655.2  0.0   83930.0\n",
      "이용금액_당사페이_R3M         0.0  0.0       0.0\n",
      "이용금액_A페이_R3M        345.6  0.0   18162.0\n",
      "이용금액_B페이_R3M         28.9  0.0    2432.0\n",
      "이용금액_C페이_R3M         34.9  0.0    2283.0\n",
      "이용금액_D페이_R3M          1.9  0.0    1030.0\n",
      "이용건수_간편결제_R3M         1.7  0.0      15.0\n",
      "이용건수_당사페이_R3M         0.0  0.0       0.0\n",
      "이용건수_A페이_R3M          0.2  0.0       3.0\n",
      "이용건수_B페이_R3M          0.0  0.0       3.0\n",
      "이용건수_C페이_R3M          0.1  0.0       3.0\n",
      "이용건수_D페이_R3M          0.0  0.0       3.0\n",
      "이용금액_간편결제_B0M       571.2  0.0   30576.0\n",
      "이용금액_당사페이_B0M         0.0  0.0       0.0\n",
      "이용금액_A페이_B0M        117.5  0.0    6581.0\n",
      "이용금액_B페이_B0M         10.8  0.0     931.0\n",
      "이용금액_C페이_B0M         15.1  0.0    1027.0\n",
      "이용금액_D페이_B0M          0.6  0.0     413.0\n",
      "이용건수_간편결제_B0M         0.6  0.0       5.0\n",
      "이용건수_당사페이_B0M         0.0  0.0       0.0\n",
      "이용건수_A페이_B0M          0.1  0.0       1.0\n",
      "이용건수_B페이_B0M          0.0  0.0       1.0\n",
      "이용건수_C페이_B0M          0.0  0.0       1.0\n",
      "이용건수_D페이_B0M          0.0  0.0       1.0\n",
      "\n",
      "📂 선결제정보:\n",
      "                 mean  min      max\n",
      "이용개월수_선결제_R6M     0.1  0.0      6.0\n",
      "이용횟수_선결제_R6M      0.5  0.0     14.0\n",
      "이용금액_선결제_R6M   1429.3  0.0  70740.0\n",
      "이용건수_선결제_R6M      3.8  0.0    550.0\n",
      "이용횟수_선결제_R3M      0.3  0.0      8.0\n",
      "이용금액_선결제_R3M    744.4  0.0  36743.0\n",
      "이용건수_선결제_R3M      2.0  0.0    296.0\n",
      "이용횟수_선결제_B0M      0.1  0.0      3.0\n",
      "이용금액_선결제_B0M    255.0  0.0  14034.0\n",
      "이용건수_선결제_B0M      0.7  0.0    168.0\n",
      "\n",
      "📂 연체정보:\n",
      "               mean  min      max\n",
      "이용횟수_연체_R6M     0.1  0.0      6.0\n",
      "이용금액_연체_R6M   276.6  0.0  20113.0\n",
      "이용횟수_연체_R3M     0.0  0.0      3.0\n",
      "이용금액_연체_R3M   134.0  0.0  10873.0\n",
      "이용횟수_연체_B0M     0.0  0.0      1.0\n",
      "이용금액_연체_B0M    44.2  0.0   4690.0\n",
      "연체입금원금_B0M   1127.1  0.0  33948.0\n",
      "연체입금원금_B2M   1121.7  0.0  33806.0\n",
      "연체입금원금_B5M   1404.7  0.0  34332.0\n",
      "\n",
      "📂 청구입금정보:\n",
      "              mean  min       max\n",
      "정상청구원금_B0M  4823.4  0.0  123364.0\n",
      "선입금원금_B0M    361.0  0.0   25159.0\n",
      "정상입금원금_B0M  3335.2  0.0  123364.0\n",
      "연체입금원금_B0M  1127.1  0.0   33948.0\n",
      "정상청구원금_B2M  4968.3  0.0  102253.0\n",
      "선입금원금_B2M    337.7  0.0   25540.0\n",
      "정상입금원금_B2M  3508.6  0.0  102253.0\n",
      "연체입금원금_B2M  1121.7  0.0   33806.0\n",
      "정상청구원금_B5M  5346.1  0.0   91802.0\n",
      "선입금원금_B5M    358.2  0.0   18584.0\n",
      "정상입금원금_B5M  3583.1  0.0   91802.0\n",
      "연체입금원금_B5M  1404.7  0.0   34332.0\n",
      "\n",
      "📂 할부전환정보:\n",
      "              mean  min      max\n",
      "건수_할부전환_R6M    0.1  0.0     11.0\n",
      "건수_할부전환_R3M    0.1  0.0      6.0\n",
      "금액_할부전환_R6M  125.4  0.0  15542.0\n",
      "금액_할부전환_R3M   68.2  0.0   8747.0\n",
      "\n",
      "📂 승인거절정보:\n",
      "                 mean  min  max\n",
      "승인거절건수_B0M        0.0  0.0  3.0\n",
      "승인거절건수_한도초과_B0M   0.0  0.0  2.0\n",
      "승인거절건수_BL_B0M     0.0  0.0  3.0\n",
      "승인거절건수_입력오류_B0M   0.0  0.0  0.0\n",
      "승인거절건수_기타_B0M     0.0  0.0  0.0\n",
      "승인거절건수_R3M        0.0  0.0  6.0\n",
      "승인거절건수_한도초과_R3M   0.0  0.0  6.0\n",
      "승인거절건수_BL_R3M     0.0  0.0  3.0\n",
      "승인거절건수_입력오류_R3M   0.0  0.0  0.0\n",
      "승인거절건수_기타_R3M     0.0  0.0  0.0\n",
      "\n",
      "📂 결제일정보:\n",
      "               mean  min  max\n",
      "이용개월수_결제일_R6M   4.2  0.0  6.0\n",
      "이용개월수_결제일_R3M   2.1  0.0  3.0\n"
     ]
    }
   ],
   "source": [
    "### 카테고리별 통계 요약 자동화\n",
    "for category, cols in column_categories.items():\n",
    "    print(f\"\\n📂 {category}:\")\n",
    "    numeric_cols = df[cols].select_dtypes(include=[np.number])\n",
    "    print(numeric_cols.describe().T[['mean', 'min', 'max']].round(1))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "d3aae12f-85cc-44ed-be3d-0cbd72410d89",
   "metadata": {},
   "outputs": [],
   "source": [
    "def clean_values(df):\n",
    "    df_copy = df.copy()\n",
    "\n",
    "    # 일자값 10101 처리 → NaT로\n",
    "    date_cols = [col for col in df_copy.columns if '일자' in col]\n",
    "    for col in date_cols:\n",
    "        df_copy[col] = pd.to_datetime(df_copy[col], format='%Y%m%d', errors='coerce')\n",
    "        df_copy.loc[df[col].astype(str).str.contains('10101'), col] = pd.NaT\n",
    "\n",
    "    # 이용건수 음수 → 0 (취소 처리), 0은 그대로\n",
    "    count_cols = [col for col in df_copy.columns if '이용건수' in col or '건수' in col]\n",
    "    for col in count_cols:\n",
    "        df_copy[col] = pd.to_numeric(df_copy[col], errors='coerce')\n",
    "        df_copy.loc[df_copy[col] < 0, col] = 0\n",
    "\n",
    "    # 이용금액 음수 → 0 (취소 처리)\n",
    "    amount_cols = [col for col in df_copy.columns if '이용금액' in col or '금액' in col]\n",
    "    for col in amount_cols:\n",
    "        df_copy[col] = pd.to_numeric(df_copy[col], errors='coerce')\n",
    "        df_copy.loc[df_copy[col] < 0, col] = 0\n",
    "\n",
    "    return df_copy\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "634b931a-2331-4460-ba26-f1ff20f8cb1e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " 결측치가 있는 컬럼 수: 18\n",
      "_3순위여유업종          498741\n",
      "_2순위여유업종          492332\n",
      "_3순위납부업종          482096\n",
      "_1순위여유업종          448266\n",
      "_3순위교통업종          431376\n",
      "_2순위납부업종          427240\n",
      "최종카드론_대출일자        414311\n",
      "최종카드론_신청경로코드      407788\n",
      "최종카드론_금융상환방식코드    407769\n",
      "_2순위교통업종          350992\n",
      "_3순위쇼핑업종          277577\n",
      "_1순위납부업종          260584\n",
      "_1순위교통업종          248447\n",
      "_2순위쇼핑업종          241949\n",
      "_3순위업종            239653\n",
      "_1순위쇼핑업종          200678\n",
      "_2순위업종            198973\n",
      "_1순위업종            119416\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# 결측치가 있는 컬럼과 그 개수 출력\n",
    "missing_counts = df.isnull().sum()\n",
    "missing_counts = missing_counts[missing_counts > 0].sort_values(ascending=False)\n",
    "\n",
    "print(\" 결측치가 있는 컬럼 수:\", len(missing_counts))\n",
    "print(missing_counts)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "f9d5c216-27c3-49c8-98fa-87573c4e7569",
   "metadata": {},
   "outputs": [],
   "source": [
    "feature_types = {\n",
    "    '식별자': [\n",
    "        'ID', '기준년월'\n",
    "    ],\n",
    "    '일자형': [\n",
    "        col for col in df.columns if '일자' in col or '경과월' in col or '개월수' in col\n",
    "    ],\n",
    "    '이산형 수치 (카운트성)': [\n",
    "        col for col in df.columns if (\n",
    "            '건수' in col or '횟수' in col\n",
    "        ) and not col.endswith('금액대')\n",
    "    ],\n",
    "    '연속형 수치 (금액 등)': [\n",
    "        col for col in df.columns if '금액' in col and '금액대' not in col\n",
    "    ],\n",
    "    '범주형': [\n",
    "        col for col in df.columns if any(kw in col for kw in [\n",
    "            '업종', '금액대', '신청경로', '상환방식코드'\n",
    "        ])\n",
    "    ],\n",
    "    '플래그/이벤트성 변수': [\n",
    "        col for col in df.columns if (\n",
    "            '승인거절' in col or '연체' in col or '무실적' in col or '유실적' in col\n",
    "        )\n",
    "    ],\n",
    "    '파생 지표/비교 지표': [\n",
    "        col for col in df.columns if '증감' in col or '최대이용' in col or '전월' in col\n",
    "    ]\n",
    "}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "15d64807-1bc7-4c65-8150-289a43ed7259",
   "metadata": {},
   "outputs": [],
   "source": [
    "def flag_nonusers_by_category(df, category_dict, flag_suffix=\"_미사용\"):\n",
    "    \"\"\"\n",
    "    각 카테고리별로 고객이 해당 항목을 '미사용'했는지 플래그 생성\n",
    "    기준: 카테고리에 포함된 컬럼 중 하나라도 0이 있으면 ⇒ 미사용자\n",
    "    \"\"\"\n",
    "    for category, cols in category_dict.items():\n",
    "        valid_cols = [col for col in cols if col in df.columns]\n",
    "        if not valid_cols:\n",
    "            continue  # 컬럼이 아예 없으면 건너뜀\n",
    "\n",
    "        df[f\"{category}{flag_suffix}\"] = df[valid_cols].eq(0).any(axis=1).astype(int)\n",
    "    \n",
    "    return df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "19422a47-1697-47a0-b9b7-a26544d77238",
   "metadata": {},
   "outputs": [],
   "source": [
    "exclude_cols = ['ID', 'Segment', '기준년월']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "bedc1ca8-3413-4bd7-a0df-c8a0f8c8115a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 수치형 컬럼 필터링\n",
    "num_cols = [\n",
    "    col for col in df.select_dtypes(include='number').columns\n",
    "    if col not in exclude_cols\n",
    "]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "22fd805a-04dc-46b0-8308-29c036546b89",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ID                 object\n",
      "최종이용일자_기본           int64\n",
      "최종이용일자_신판           int64\n",
      "최종이용일자_CA           int64\n",
      "최종이용일자_카드론          int64\n",
      "                    ...  \n",
      "승인거절건수_한도초과_R3M     int64\n",
      "승인거절건수_BL_R3M       int64\n",
      "승인거절건수_입력오류_R3M     int64\n",
      "승인거절건수_기타_R3M       int64\n",
      "이용금액대              object\n",
      "Length: 405, dtype: object\n"
     ]
    }
   ],
   "source": [
    "print(df.dtypes)  # 각 컬럼의 데이터 타입 확인"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "ce1575de-6061-44af-bd99-bd8e2d5b53e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 코드에 one-hot encoding\n",
    "df = pd.get_dummies(df, columns=['최종카드론_신청경로코드', '최종카드론_금융상환방식코드'], drop_first=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "46d2a12e-1c53-4ab9-9886-9736243a46a7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "_1순위업종\n",
      "_2순위업종\n",
      "_3순위업종\n",
      "_1순위쇼핑업종\n",
      "_2순위쇼핑업종\n",
      "_3순위쇼핑업종\n",
      "_1순위교통업종\n",
      "_2순위교통업종\n",
      "_3순위교통업종\n",
      "_1순위여유업종\n",
      "_2순위여유업종\n",
      "_3순위여유업종\n",
      "_1순위납부업종\n",
      "_2순위납부업종\n",
      "_3순위납부업종\n"
     ]
    }
   ],
   "source": [
    "for col in df.columns:\n",
    "    if '업종' in col and df[col].dtype == 'object':\n",
    "        print(col)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "8ed77cef-559a-41f9-a9d2-e42d193167ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "업종_문자_컬럼 = [col for col in df.columns if '업종' in col and df[col].dtype == 'object']\n",
    "df = pd.get_dummies(df, columns=업종_문자_컬럼, drop_first=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "93e87ee3-ef6f-48f6-aeaa-7be5339820b9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " 결측치가 있는 컬럼 수: 1\n",
      "최종카드론_대출일자    414311\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# 결측치가 있는 컬럼과 그 개수 출력\n",
    "missing_counts = df.isnull().sum()\n",
    "missing_counts = missing_counts[missing_counts > 0].sort_values(ascending=False)\n",
    "\n",
    "print(\" 결측치가 있는 컬럼 수:\", len(missing_counts))\n",
    "print(missing_counts)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "77183934-277c-419e-b58a-380f11ba1773",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.drop(columns=['최종카드론_대출일자'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "5350a243-6277-45d2-ac3e-0cb4a8253d06",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "🔍 object 타입 컬럼:\n",
      "['ID', '이용금액대']\n"
     ]
    }
   ],
   "source": [
    "object_cols = df.select_dtypes(include='object').columns\n",
    "print(\"🔍 object 타입 컬럼:\")\n",
    "print(object_cols.tolist())\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "2b92f3ca-cf0d-454b-bcdd-b185d4bba02a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.drop(columns=['이용금액_숫자'])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "9b749aa8-4b20-4eff-8b37-9fb08eb1e25e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['이용금액대'] = df['이용금액대'].fillna('Missing')  # 결측치 처리\n",
    "df = pd.get_dummies(df, columns=['이용금액대'], drop_first=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "ea73730c-0ffa-47c1-91f1-f1deaf4b08dd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   이용금액대_02.50만원+  이용금액대_03.30만원+  이용금액대_04.10만원+  이용금액대_05.10만원-  \\\n",
      "0           False           False           False           False   \n",
      "1           False            True           False           False   \n",
      "2           False           False           False           False   \n",
      "3           False           False           False           False   \n",
      "4           False           False           False            True   \n",
      "\n",
      "   이용금액대_09.미사용  \n",
      "0         False  \n",
      "1         False  \n",
      "2         False  \n",
      "3         False  \n",
      "4         False  \n"
     ]
    }
   ],
   "source": [
    "print(df.filter(like='이용금액대').head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "91f2524e-0a3b-4401-807a-a91cc49bea28",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['ID', '최종이용일자_기본', '최종이용일자_신판', '최종이용일자_CA', '최종이용일자_카드론', '최종이용일자_체크',\n",
      "       '최종이용일자_일시불', '최종이용일자_할부', '이용건수_신용_B0M', '이용건수_신판_B0M',\n",
      "       ...\n",
      "       '_2순위납부업종_보험료', '_2순위납부업종_통신비', '_3순위납부업종_납부기타', '_3순위납부업종_보험료',\n",
      "       '_3순위납부업종_통신비', '이용금액대_02.50만원+', '이용금액대_03.30만원+', '이용금액대_04.10만원+',\n",
      "       '이용금액대_05.10만원-', '이용금액대_09.미사용'],\n",
      "      dtype='object', length=485)\n"
     ]
    }
   ],
   "source": [
    "print(df.columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "6c4278b5-6804-4f9a-b779-ed8d07b90d1d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ID                0\n",
      "최종이용일자_기본         0\n",
      "최종이용일자_신판         0\n",
      "최종이용일자_CA         0\n",
      "최종이용일자_카드론        0\n",
      "                 ..\n",
      "이용금액대_02.50만원+    0\n",
      "이용금액대_03.30만원+    0\n",
      "이용금액대_04.10만원+    0\n",
      "이용금액대_05.10만원-    0\n",
      "이용금액대_09.미사용      0\n",
      "Length: 485, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "print(df.isnull().sum())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "1d4bfdd3-be00-4d7f-90c2-b58bd15538fc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "🔍 object 타입 컬럼:\n",
      "['ID']\n"
     ]
    }
   ],
   "source": [
    "object_cols = df.select_dtypes(include='object').columns\n",
    "print(\"🔍 object 타입 컬럼:\")\n",
    "print(object_cols.tolist())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "4552d8fa-4659-4328-9b73-fe029212c832",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv(\"최종분석데이터셋_승인매출정보2.csv\", index=False, encoding=\"utf-8-sig\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "33ccc0e6-9990-4ed7-a3f3-502cfb989a4d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "📅 일자 관련 컬럼의 결측치 개수:\n",
      "최종이용일자_기본     0\n",
      "최종이용일자_신판     0\n",
      "최종이용일자_CA     0\n",
      "최종이용일자_카드론    0\n",
      "최종이용일자_체크     0\n",
      "최종이용일자_일시불    0\n",
      "최종이용일자_할부     0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# '일자'라는 단어가 들어간 컬럼만 골라냄\n",
    "date_cols = [col for col in df.columns if '일자' in col]\n",
    "\n",
    "# 해당 컬럼들만 골라서 결측치 개수 확인\n",
    "missing_dates = df[date_cols].isnull().sum()\n",
    "\n",
    "print(\"📅 일자 관련 컬럼의 결측치 개수:\")\n",
    "print(missing_dates)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "3529c97e-656b-462e-adc0-7d65bb7725ae",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "📋 행 개수: 500000\n"
     ]
    }
   ],
   "source": [
    "print(f\"📋 행 개수: {df.shape[0]}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "53f52f1e-486e-4fb8-b757-9554d3914edb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "🧹 제거된 컬럼 수: 42개\n",
      "🧾 제거된 컬럼 목록:\n",
      "['이용건수_부분무이자_B0M', '이용금액_부분무이자_B0M', '이용건수_부분무이자_R6M', '이용금액_부분무이자_R6M', '이용건수_부분무이자_R3M', '이용금액_부분무이자_R3M', '이용개월수_부분무이자_R3M', '여유_여행이용금액', '납부_렌탈료이용금액', '납부_유선방송이용금액', '납부_건강연금이용금액', '할부건수_무이자_14M_R12M', '할부건수_부분_3M_R12M', '할부건수_부분_6M_R12M', '할부건수_부분_14M_R12M', '할부금액_부분_3M_R12M', '할부금액_부분_6M_R12M', 'RP건수_유선방송_B0M', 'RP건수_건강_B0M', 'RP후경과월_유선방송', 'RP후경과월_건강', '증감_RP건수_유선방송_전월', '증감_RP건수_건강_전월', '이용개월수_당사페이_R6M', '이용개월수_당사기타_R6M', '이용금액_당사페이_R6M', '이용금액_당사기타_R6M', '이용건수_당사페이_R6M', '이용건수_당사기타_R6M', '이용금액_당사페이_R3M', '이용금액_당사기타_R3M', '이용건수_당사페이_R3M', '이용건수_당사기타_R3M', '이용금액_당사페이_B0M', '이용금액_당사기타_B0M', '이용건수_당사페이_B0M', '이용건수_당사기타_B0M', '신청건수_ATM_CL_B0', '승인거절건수_입력오류_B0M', '승인거절건수_기타_B0M', '승인거절건수_입력오류_R3M', '승인거절건수_기타_R3M']\n"
     ]
    }
   ],
   "source": [
    "# 값이 하나만 있는 컬럼만 골라내기\n",
    "single_value_cols = [col for col in df.columns if df[col].nunique() == 1]\n",
    "\n",
    "# 제거\n",
    "df = df.drop(columns=single_value_cols)\n",
    "\n",
    "print(f\"🧹 제거된 컬럼 수: {len(single_value_cols)}개\")\n",
    "print(\"🧾 제거된 컬럼 목록:\")\n",
    "print(single_value_cols)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "49c2ef11-17b1-41d5-bd74-52954ed4d95d",
   "metadata": {},
   "outputs": [],
   "source": [
    "date_cols = [col for col in df.columns if '일자' in col]\n",
    "\n",
    "for col in date_cols:\n",
    "    # NaN 여부를 이진 변수로 생성 (0: 정상, 1: 결측)\n",
    "    df[f'{col}_결측'] = df[col].isnull().astype(int)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "704b5e4e-c826-40f9-8f7f-b6e32ea815cf",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e1c5f4d6-0f7f-43f1-a30f-00892ba7f307",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
